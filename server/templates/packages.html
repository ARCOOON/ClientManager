{% extends "base.html" %}
{% block content %}
<h1 class="mb-4">Packages</h1>
<div class="card shadow-sm mb-4">
  <div class="card-body">
    <h5 class="card-title">Create package</h5>
    <form method="post" action="/packages" class="row g-2">
      <div class="col-md-3">
        <input type="text" name="name" class="form-control form-control-sm" placeholder="Name" required />
      </div>
      <div class="col-md-2">
        <input type="text" name="version" class="form-control form-control-sm" placeholder="Version" required />
      </div>
      <div class="col-md-2">
        <select name="platform" class="form-select form-select-sm" required>
          <option value="win">Windows</option>
          <option value="linux">Linux</option>
        </select>
      </div>
      <div class="col-md-3">
        <input type="url" name="download_url" class="form-control form-control-sm" placeholder="Download URL" />
      </div>
      <div class="col-md-2">
        <input type="text" name="sha256" class="form-control form-control-sm" placeholder="SHA256" />
      </div>
      <div class="col-md-4">
        <input type="text" name="install_cmd" class="form-control form-control-sm" placeholder="Install command" />
      </div>
      <div class="col-md-4">
        <input type="text" name="uninstall_cmd" class="form-control form-control-sm" placeholder="Uninstall command" />
      </div>
      <div class="col-md-4">
        <input type="text" name="silent_args" class="form-control form-control-sm" placeholder="Silent args" />
      </div>
      <div class="col-md-4">
        <input type="text" name="precheck_cmd" class="form-control form-control-sm" placeholder="Pre‑check command" />
      </div>
      <div class="col-md-4">
        <input type="text" name="postcheck_cmd" class="form-control form-control-sm" placeholder="Post‑check command" />
      </div>
      <div class="col-md-4">
        <input type="text" name="expected_exit_codes" class="form-control form-control-sm" placeholder="Exit codes (csv)" />
      </div>
      <div class="col-12 text-end">
        <button class="btn btn-dark btn-sm">Create</button>
      </div>
    </form>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body p-0">
    <table class="table table-striped mb-0">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Version</th>
          <th>Platform</th>
          <th>Download URL</th>
        </tr>
      </thead>
      <tbody>
        {% for p in packages %}
        <tr>
          <td>{{ p.id }}</td>
          <td>{{ p.name }}</td>
          <td>{{ p.version }}</td>
          <td>{{ p.platform }}</td>
          <td><a href="{{ p.download_url }}" target="_blank">{{ p.download_url[:30] }}{% if p.download_url|length > 30 %}…{% endif %}</a></td>
        </tr>
        {% else %}
        <tr><td colspan="5" class="text-center text-muted">No packages created</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}